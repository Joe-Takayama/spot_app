{% extends 'base/base.html' %}
{% load static %}
{% block title %}ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/event_chart.css' %}">
{% endblock %}

{% block body %}
<div class="admin-container">

  <h2 class="page-title">ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</h2>

  <!-- ğŸ”¹ æœˆãƒœã‚¿ãƒ³ -->
  <div class="month-select">
    <a href="{% url 'spotapp:event_chart' %}?page=1"
       class="month-btn {% if not selected_month %}active{% endif %}">
      ALL
    </a>

    {% for m in months %}
      <a href="?month={{ m }}&page=1"
         class="month-btn {% if selected_month == m|stringformat:'s' %}active{% endif %}">
        {{ m }}æœˆ
      </a>
    {% endfor %}
  </div>

  <!-- â—† ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ -->
  {% for event in event_list %}
    <div class="event-card">
      <h3>{{ event.event_name }}</h3>

      <p>
        ğŸ“… {{ event.event_start|date:"Yå¹´næœˆjæ—¥" }} ã€œ {{ event.event_end|date:"Yå¹´næœˆjæ—¥" }}
      </p>

      <p>
        ğŸ“
        {% if event.spot_id %}
          <a href="{% url 'spotapp:spot_detail' event.spot_id.spot_id %}"
             class="event-spot-link">
            {{ event.spot_id.spot_name }}
          </a>
        {% else %}
          {{ event.venue }}
        {% endif %}
      </p>

      <p class="description">
        {{ event.details|truncatechars:50 }}
      </p>

      <a href="{% url 'spotapp:event_detail' event.event_id %}"
         class="detail-link">
        è©³ç´°ã‚’è¦‹ã‚‹ â†’
      </a>
    </div>
  {% empty %}
    <p>ã“ã®æœˆã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  {% endfor %}

</div>

<!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
{% if page_obj.paginator.num_pages > 1 %}
<div class="pagination">

  {% if page_obj.has_previous %}
    <a href="?{% if selected_month %}month={{ selected_month }}&{% endif %}page={{ page_obj.previous_page_number }}">
      â†å‰ã®ãƒšãƒ¼ã‚¸ã¸
    </a>
  {% endif %}

  <span>
    {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
  </span>

  {% if page_obj.has_next %}
    <a href="?{% if selected_month %}month={{ selected_month }}&{% endif %}page={{ page_obj.next_page_number }}">
      æ¬¡ã®ãƒšãƒ¼ã‚¸ã¸â†’
    </a>
  {% endif %}
</div>
{% endif %}
{% endblock %}
